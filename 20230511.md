# Turtlesim

### Python
> 1. yh_turtle폴더 안에 scripts 폴더 생성, turtle_patrol.py파일을 생성

```python
#!/usr/bin/python
#!-*- cording : utf-8 -*-

import rospy
from geometry_msgs.msg import Twist

rospy.init_node("turtle_patrol")
pub = rospy.Publisher("turtle1/cmd_vel", Twist, queue_size=10);

loop_rate = rospy.Rate(1)

# 값을 않넣으면 0의 값으로 자동입력된다.
msg = Twist()
msg.linear.x = 1.0

while not rospy.is_shutdown():
    pub.publish(msg)
    msg.linear.x *= -1.0
    loop_rate.sleep()
```

> 2. CMakeLists.txt에 catkin_install_python을 수정
> 3. 'cm' 빌드 이후 'roscore, rosrun turtlesim turtlesim_node, rosrun yh_turtle turtle_patrol.py'실행
> * rostopic echo /turtle1/cmd_vel = subscriber를 바로 생성하는 코드

# Ros launch
* 실행시 여러개의 노드들을 켜는 일은 줄여주는 역할

> 1. yh_turtle폴더에 launch폴더를 생성
> 2. turtle_patrol.launch (확장자 : .launch)파일 생성 

```
<launch>
    <!-- rosrun turtlesim turtlesim_node -->
    <node pkg="turtlesim" type="turtlesim_node" name="turtleturtle"/>
    <!-- rosrun yh_turtle turtle_patrol.py -->
    <node pkg="yh_turtle" type = "turtle_patrol.py" name = "patrolpatrol"/>
</launch>
```

> * pkg : 패키지 이름, type : 노드 이름, name : 사용할 이름
> 3. roslaunch yh_turtle turtle_patrol.launch로 launch를 실행 할 수 있다.
> * launch로 실행을 한경우에만 name이 적용되서 rqt에 볼 수 있다.

# 제어를 위한 패키지
* apt 저장소 받는방법, 소스코드 받아서 직접 빌드하는 방법 2가지가 존재한다.

### 저장소 받는방법
> 1. sudo apt install ros-noetic-teleop-twist-keyboard로 설치
>   * 키보드 사용해서 조종하는 패키지
> 2. roscore를 실행, rosrun teleop_twist_keyboard teleop_twist_keyboard.py를 실행
>   * Waiting for subscriber to connect to /cmd_vel 오류출력 subscriber가 필요
> 3. rostopic echo /cmd_vel  
>   * 오류 창 아래에 움직이는 방식이 출력, Holonomic과 unHolonomic이 출력
>   * Holonomic과 unHolonomic은 옆으로의 이동의 유무 차이

# Turtlesim 과 keyboard 연결

> 1. yh_turtle폴더 안에 src폴더 안에 turtle_keyboard.cpp파일 생성

```cpp
#include "ros/ros.h"
#include "geometry_msgs/Twist.h"

// cmd_vel 토픽 subscribe ==> turtle1/cmd_vel 토픽 publish

ros::Publisher pub;

void msgCallback(const geometry_msgs::Twist::ConstPtr& msg){
    pub.publish(*msg);
}

int main(int argc, char** argv){
    ros::init(argc, argv, "turtle_keyboard");
    ros::NodeHandle nh;

    pub = nh.advertise<geometry_msgs::Twist>("turtle1/cmd_vel", 10);
    ros::Subscriber sub = nh.subscribe("cmd_vel", 10, msgCallback);

    return 0;
}
```

> 2. CMakeLists.txt에서 수정후 빌드
















